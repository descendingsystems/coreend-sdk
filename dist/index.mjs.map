{"version":3,"file":"index.mjs","sources":["../src/helper.ts","../src/index.ts"],"sourcesContent":["export function isBrowser() {\n  return typeof window !== 'undefined';\n}\n","import axios, { AxiosInstance, AxiosRequestHeaders } from 'axios';\nimport { isBrowser } from './helper';\n\ntype SDKInstance = {\n  initialized: boolean;\n  projectId: number;\n  api: AxiosInstance;\n};\n\nconst instance: SDKInstance = {\n  initialized: false,\n  projectId: -1,\n  api: axios.create(),\n};\n\n// General\nexport function initCoreEnd(projectId: number) {\n  if (instance.initialized) throw new Error('[COREEND] SDK has already been initialized');\n\n  instance.projectId = projectId;\n  instance.api = axios.create({\n    baseURL: `https://api.coreend.tech/v1/projects/${projectId}/`,\n  });\n  instance.initialized = true;\n}\n\nfunction enforceIsInitialized() {\n  if (!instance.initialized) throw new Error('[COREEND] SDK has not been initialized');\n}\n\n// Resource Docs\nexport function resourceDocs(resourceId: number) {\n  enforceIsInitialized();\n\n  async function get({\n    id,\n    page,\n    requireAuth,\n  }: { id?: number; page?: number; requireAuth?: boolean } = {}): Promise<\n    | { error: null; items: Record<string, any>[] | Record<string, any> }\n    | { error: any; items: null }\n  > {\n    try {\n      const withId = typeof id === 'number' ? id : '';\n      const withPage = typeof page === 'number' ? `page=${page}` : '';\n      const withQuries = `${withPage}`;\n\n      const configHeaders: AxiosRequestHeaders = {};\n\n      if (requireAuth) {\n        const authInstance = authentication();\n        const accessTokenRes = await authInstance.getAccessToken();\n\n        if (accessTokenRes.error)\n          throw new Error(`Can not get access token: ${accessTokenRes.error}`);\n\n        configHeaders.Authorization = `Bearer ${accessTokenRes.accessToken}`;\n      }\n\n      const result = await instance.api.get(\n        `resources/${resourceId}/docs/${withId}?${withQuries}`,\n        { headers: configHeaders }\n      );\n      const data = result.data as any;\n\n      return { error: null, items: data };\n    } catch (error) {\n      return { error, items: null };\n    }\n  }\n\n  async function create(\n    item: Record<string, any>,\n    requireAuth = false,\n    hCaptchaResponse = ''\n  ): Promise<{ error: null; id: number } | { error: any; id: null }> {\n    try {\n      const configHeaders: AxiosRequestHeaders = {};\n\n      if (requireAuth) {\n        const authInstance = authentication();\n        const accessTokenRes = await authInstance.getAccessToken();\n\n        if (accessTokenRes.error)\n          throw new Error(`Can not get access token: ${accessTokenRes.error}`);\n\n        configHeaders.Authorization = `Bearer ${accessTokenRes.accessToken}`;\n      }\n\n      const withHCaptchaResponse = hCaptchaResponse ? `hcaptchaResponse=${hCaptchaResponse}&` : '';\n      const withQuries = `${withHCaptchaResponse}`;\n\n      const result = await instance.api.post(\n        `resources/${resourceId}/docs?${withQuries}`,\n        { data: item },\n        {\n          headers: configHeaders,\n        }\n      );\n\n      const data = result.data as number;\n\n      return { error: null, id: data };\n    } catch (error) {\n      return { error, id: null };\n    }\n  }\n\n  async function update(\n    item: Record<string, any>,\n    requireAuth = false\n  ): Promise<{ error: null } | { error: any }> {\n    try {\n      const configHeaders: AxiosRequestHeaders = {};\n\n      if (requireAuth) {\n        const authInstance = authentication();\n        const accessTokenRes = await authInstance.getAccessToken();\n\n        if (accessTokenRes.error)\n          throw new Error(`Can not get access token: ${accessTokenRes.error}`);\n\n        configHeaders.Authorization = `Bearer ${accessTokenRes.accessToken}`;\n      }\n\n      await instance.api.put(\n        `resources/${resourceId}/docs`,\n        { data: item },\n        { headers: configHeaders }\n      );\n\n      return { error: null };\n    } catch (error) {\n      return { error };\n    }\n  }\n\n  async function remove(\n    id: number,\n    requireAuth = false\n  ): Promise<{ error: null } | { error: any }> {\n    try {\n      const configHeaders: AxiosRequestHeaders = {};\n\n      if (requireAuth) {\n        const authInstance = authentication();\n        const accessTokenRes = await authInstance.getAccessToken();\n\n        if (accessTokenRes.error)\n          throw new Error(`Can not get access token: ${accessTokenRes.error}`);\n\n        configHeaders.Authorization = `Bearer ${accessTokenRes.accessToken}`;\n      }\n\n      await instance.api.delete(`resources/${resourceId}/docs/${id}`, { headers: configHeaders });\n\n      return { error: null };\n    } catch (error) {\n      return { error };\n    }\n  }\n\n  return { get, create, update, remove };\n}\n\n// Authentication\ntype signedInUser = {\n  isSignedIn: boolean;\n  accessToken: string;\n  refreshToken: string;\n  expiresOn: number;\n};\n\ntype Profile = {\n  uid: string;\n  email: string;\n};\n\nconst signedInUser: signedInUser = {\n  isSignedIn: false,\n  accessToken: '',\n  refreshToken: '',\n  expiresOn: 0,\n};\n\nexport function authentication() {\n  enforceIsInitialized();\n\n  const defaultAccessTokenExpirationInMin = 15;\n  const defaultLocalStorageRefreshTokenKey = 'coreend-sdk-authentication-refreshToken';\n\n  if (!signedInUser.isSignedIn && isBrowser()) {\n    const refreshToken = window.localStorage.getItem(defaultLocalStorageRefreshTokenKey);\n\n    if (refreshToken) {\n      signedInUser.refreshToken = refreshToken;\n      signedInUser.isSignedIn = true;\n    }\n  }\n\n  function isSignedIn() {\n    return signedInUser.isSignedIn;\n  }\n\n  async function getAccessToken(): Promise<\n    { error: null; accessToken: string } | { error: any; accessToken: null }\n  > {\n    try {\n      if (!isSignedIn()) throw new Error('Not signed in');\n\n      // Renew access token if close to expiration\n      if (Date.now() >= signedInUser.expiresOn - 1000 * 30) {\n        const renewStatus = await renew();\n\n        if (renewStatus.error) {\n          await logout();\n          throw new Error('Could not renew access token');\n        }\n      }\n\n      return { error: null, accessToken: signedInUser.accessToken };\n    } catch (error) {\n      await logout();\n      return { error, accessToken: null };\n    }\n  }\n\n  async function login(email: string): Promise<{ error: null } | { error: any }> {\n    try {\n      if (isSignedIn()) throw new Error('Already signed in');\n\n      await instance.api.post(`auth/login`, {\n        email,\n      });\n\n      return { error: null };\n    } catch (error) {\n      return { error };\n    }\n  }\n\n  async function verify(email: string, otp: string): Promise<{ error: null } | { error: any }> {\n    try {\n      if (isSignedIn()) throw new Error('Already signed in');\n\n      const res = await instance.api.post(`auth/verify`, {\n        email,\n        otp,\n      });\n\n      signedInUser.accessToken = res.data.accessToken || '';\n      signedInUser.refreshToken = res.data.refreshToken || '';\n      signedInUser.expiresOn = Date.now() + 60000 * defaultAccessTokenExpirationInMin;\n      signedInUser.isSignedIn = true;\n\n      if (!signedInUser.accessToken || !signedInUser.refreshToken)\n        throw new Error('Could not sign in');\n\n      if (isBrowser())\n        window.localStorage.setItem(defaultLocalStorageRefreshTokenKey, signedInUser.refreshToken);\n\n      return { error: null };\n    } catch (error) {\n      return { error };\n    }\n  }\n\n  async function profile(): Promise<\n    { error: null; profile: Profile } | { error: any; profile: null }\n  > {\n    try {\n      if (!isSignedIn()) throw new Error('Not signed in');\n      const accessTokenRes = await getAccessToken();\n\n      if (accessTokenRes.error)\n        throw new Error(`Can not get access token: ${accessTokenRes.error}`);\n\n      const res = await instance.api.get(`auth/profile`, {\n        headers: {\n          Authorization: `Bearer ${accessTokenRes.accessToken}`,\n        },\n      });\n\n      const profile = {\n        uid: res.data.uid || '',\n        email: res.data.email || '',\n      };\n\n      if (!profile.uid || !profile.email) throw new Error('Could not get profile');\n\n      return { error: null, profile };\n    } catch (error) {\n      return { error, profile: null };\n    }\n  }\n\n  async function renew(): Promise<{ error: null } | { error: any }> {\n    try {\n      if (!isSignedIn()) throw new Error('Not signed in');\n\n      const res = await instance.api.post(`auth/renew`, {\n        refreshToken: signedInUser.refreshToken,\n      });\n\n      signedInUser.accessToken = res.data.accessToken;\n      signedInUser.expiresOn = Date.now() + 60000 * defaultAccessTokenExpirationInMin;\n\n      return { error: null };\n    } catch (error) {\n      await logout();\n      return { error };\n    }\n  }\n\n  async function invalidate(): Promise<{ error: null } | { error: any }> {\n    try {\n      if (!isSignedIn()) throw new Error('Not signed in');\n\n      await instance.api.post(`auth/invalidate`, {\n        refreshToken: signedInUser.refreshToken,\n      });\n\n      return { error: null };\n    } catch (error) {\n      return { error };\n    } finally {\n      await logout();\n    }\n  }\n\n  async function remove(): Promise<{ error: null } | { error: any }> {\n    try {\n      if (!isSignedIn()) throw new Error('Not signed in');\n      const accessTokenRes = await getAccessToken();\n\n      if (accessTokenRes.error)\n        throw new Error(`Can not get access token: ${accessTokenRes.error}`);\n\n      await instance.api.delete(`auth/remove`, {\n        headers: {\n          Authorization: `Bearer ${accessTokenRes.accessToken}`,\n        },\n      });\n\n      return { error: null };\n    } catch (error) {\n      return { error };\n    } finally {\n      await logout();\n    }\n  }\n\n  async function logout(): Promise<{ error: null } | { error: any }> {\n    try {\n      if (!isSignedIn()) throw new Error('Not signed in');\n\n      if (isBrowser()) window.localStorage.removeItem(defaultLocalStorageRefreshTokenKey);\n\n      signedInUser.isSignedIn = false;\n      signedInUser.accessToken = '';\n      signedInUser.refreshToken = '';\n      signedInUser.expiresOn = 0;\n\n      return { error: null };\n    } catch (error) {\n      return { error };\n    }\n  }\n\n  return {\n    isSignedIn,\n    getAccessToken,\n    login,\n    verify,\n    profile,\n    renew,\n    invalidate,\n    remove,\n    logout,\n  };\n}\n\n// Storage Files\nexport function storageFiles(storageId: number) {\n  enforceIsInitialized();\n\n  async function get(\n    fileName: string,\n    requireAuth = false\n  ): Promise<{ error: null; url: any } | { error: any; url: null }> {\n    try {\n      const configHeaders: AxiosRequestHeaders = {};\n\n      if (requireAuth) {\n        const authInstance = authentication();\n        const accessTokenRes = await authInstance.getAccessToken();\n\n        if (accessTokenRes.error)\n          throw new Error(`Can not get access token: ${accessTokenRes.error}`);\n\n        configHeaders.Authorization = `Bearer ${accessTokenRes.accessToken}`;\n      }\n\n      const result = await instance.api.get(`storages/${storageId}/files/${fileName}`, {\n        headers: configHeaders,\n      });\n      const data = result.data as { url: string };\n\n      return { error: null, url: data.url };\n    } catch (error) {\n      return { error, url: null };\n    }\n  }\n\n  async function create(\n    file: File,\n    fileName?: string,\n    requireAuth = false,\n    hCaptchaResponse = ''\n  ): Promise<{ error: null } | { error: any }> {\n    try {\n      const configHeaders: AxiosRequestHeaders = {};\n\n      if (requireAuth) {\n        const authInstance = authentication();\n        const accessTokenRes = await authInstance.getAccessToken();\n\n        if (accessTokenRes.error)\n          throw new Error(`Can not get access token: ${accessTokenRes.error}`);\n\n        configHeaders.Authorization = `Bearer ${accessTokenRes.accessToken}`;\n      }\n\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('fileName', fileName || file.name);\n\n      const withHCaptchaResponse = hCaptchaResponse ? `hcaptchaResponse=${hCaptchaResponse}&` : '';\n      const withQuries = `${withHCaptchaResponse}`;\n\n      await instance.api.post(`storages/${storageId}/files?${withQuries}`, formData, {\n        headers: configHeaders,\n      });\n\n      return { error: null };\n    } catch (error) {\n      return { error };\n    }\n  }\n\n  async function remove(\n    fileName: string,\n    requireAuth = false\n  ): Promise<{ error: null } | { error: any }> {\n    try {\n      const configHeaders: AxiosRequestHeaders = {};\n\n      if (requireAuth) {\n        const authInstance = authentication();\n        const accessTokenRes = await authInstance.getAccessToken();\n\n        if (accessTokenRes.error)\n          throw new Error(`Can not get access token: ${accessTokenRes.error}`);\n\n        configHeaders.Authorization = `Bearer ${accessTokenRes.accessToken}`;\n      }\n\n      await instance.api.delete(`storages/${storageId}/files/${fileName}`, {\n        headers: configHeaders,\n      });\n\n      return { error: null };\n    } catch (error) {\n      return { error };\n    }\n  }\n\n  return { get, create, remove };\n}\n"],"names":["window","instance","initialized","projectId","api","axios","create","initCoreEnd","Error","baseURL","enforceIsInitialized","resourceDocs","resourceId","get","_temp3","_ref","id","page","requireAuth","Promise","resolve","_catch","withId","withQuries","headers","configHeaders","result","error","items","data","authInstance","authentication","getAccessToken","accessTokenRes","Authorization","accessToken","_temp","then","_temp2","e","reject","item","hCaptchaResponse","_temp5","_result2","post","_temp4","update","_temp7","_result3","put","_temp6","remove","_temp9","_result4","_temp8","isSignedIn","refreshToken","expiresOn","logout","isBrowser","localStorage","removeItem","defaultLocalStorageRefreshTokenKey","signedInUser","renew","res","Date","now","defaultAccessTokenExpirationInMin","_temp11","_result5","_temp10","renewStatus","getItem","login","email","verify","otp","setItem","profile","uid","invalidate","_finallyRethrows","_wasThrown","_result7","_wasThrown2","_result8","storageFiles","storageId","fileName","url","_temp12","_temp13","file","_temp15","_result10","formData","FormData","append","name","_temp14","_temp17","_result11","_temp16"],"mappings":"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"}